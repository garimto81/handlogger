# PRD - Unified Apps Script Project

## ðŸ“‹ ë¬¸ì„œ ì •ë³´
- **ìž‘ì„±ì¼**: 2025-10-06
- **ë²„ì „**: v2.6.1
- **ìƒíƒœ**: ìž‘ì—… ëª©ë¡ (ë™ì )

---

## Phase 1: í†µí•© MVP (v1.0~v2.6) âœ… ì™„ë£Œ

### 1.1 ë¹Œë“œ ì‹œìŠ¤í…œ êµ¬ì¶• âœ… ì™„ë£Œ
- **ê·¼ê±°**: PLANì˜ ì‹œë‚˜ë¦¬ì˜¤ 1 (ì²« í†µí•© ë°°í¬) í•´ê²°
- **ì„±ê³µ**: PLANì˜ "ë°°í¬ ì†Œìš” ì‹œê°„ 30ë¶„ â†’ 5ë¶„" ë‹¬ì„±
- **ì™„ë£Œì¼**: 2025-10-06
- **ê²°ê³¼**: v2.6.0 ë°°í¬

### 1.2 ë„¤ìž„ìŠ¤íŽ˜ì´ìŠ¤ ì¶©ëŒ ë°©ì§€ âœ… ì™„ë£Œ
- **ê·¼ê±°**: PLANì˜ ì‹œë‚˜ë¦¬ì˜¤ 2 (ì½”ë“œ ìˆ˜ì • í›„ ìž¬ë°°í¬) í•´ê²°
- **ì„±ê³µ**: PLANì˜ "í•¨ìˆ˜ëª… ì¶©ëŒ 0ê±´" ë‹¬ì„±
- **ì™„ë£Œì¼**: 2025-10-06
- **ê²°ê³¼**: tracker_*, soft_* prefix ìžë™ ì¶”ê°€

### 1.3 CSS ìŠ¤ì½”í•‘ âœ… ì™„ë£Œ
- **ê·¼ê±°**: PLANì˜ ì œì•½ ì‚¬í•­ (CSS ì¶©ëŒ ë°©ì§€)
- **ì„±ê³µ**: Tracker/SoftSender ìŠ¤íƒ€ì¼ ê²©ë¦¬
- **ì™„ë£Œì¼**: 2025-10-06
- **ê²°ê³¼**: #panelTracker, #panelSoftsender

### 1.4 ë¹Œë“œ ë²„ê·¸ ìˆ˜ì • (v6-8) âœ… ì™„ë£Œ
- **ê·¼ê±°**: PLANì˜ ì‹œë‚˜ë¦¬ì˜¤ 2 (ìž¬ë°°í¬ ì›Œí¬í”Œë¡œìš°)
- **ì„±ê³µ**: í•¨ìˆ˜ í˜¸ì¶œ ì—ëŸ¬ 0ê±´, UI ë ˆì´ì•„ì›ƒ ì •ìƒ
- **ì™„ë£Œì¼**: 2025-10-06
- **ê²°ê³¼**:
  - í•¨ìˆ˜ëª… ì •ê·œì‹ ìˆ˜ì • (`.getKeyPlayers(` â†’ `\.getKeyPlayers(`)
  - CSS ì¶©ëŒ í•´ê²° (#panelTracker ìŠ¤ì½”í•‘)

### 1.5 ë¬¸ì„œ ì •ë¦¬ âœ… ì™„ë£Œ
- **ê·¼ê±°**: PLANì˜ í•µì‹¬ ì›ì¹™ (ë‹¨ì¼ ì§„ì‹¤ ê³µê¸‰ì›)
- **ì„±ê³µ**: ì¤‘ë³µ ë¬¸ì„œ 0ê°œ, êµ¬ì¡° ëª…í™•í™”
- **ì™„ë£Œì¼**: 2025-10-06
- **ê²°ê³¼**: 16ê°œ ìž„ì‹œ ë¬¸ì„œ ì‚­ì œ, docs/ êµ¬ì¡°í™”

---

## Phase 2: ì½”ë“œ ëª¨ë“ˆí™” âœ… ì™„ë£Œ (v2.7.0)

### 2.1 ê³µí†µ ëª¨ë“ˆ ì¶”ì¶œ âœ… ì™„ë£Œ
- **ê·¼ê±°**: PLANì˜ "ì½”ë“œ ìž¬ì‚¬ìš©" ëª©í‘œ, LLDì˜ "ëª¨ë“ˆí™” ì „ëžµ"
- **ì„±ê³µ**: PLANì˜ "ì½”ë“œ ì¤‘ë³µ 67% ê°ì†Œ" ë‹¬ì„±
- **ì˜ì¡´ì„± í•´ê²° ì „ëžµ**: ë¹Œë“œ íƒ€ìž„ ë³‘í•© ë°©ì‹
  - âœ… **ê°œë°œ ì‹œ**: src/ íŒŒì¼ë“¤ì€ ë…¼ë¦¬ì  ë¶„ë¦¬ë§Œ (ê°€ë…ì„± í–¥ìƒ)
  - âœ… **ë¹Œë“œ ì‹œ**: build.jsê°€ ì˜¬ë°”ë¥¸ ìˆœì„œë¡œ ë³‘í•© (common â†’ handlogger â†’ tracker â†’ soft)
  - âœ… **ë°°í¬ ì‹œ**: dist/code.gsëŠ” ë‹¨ì¼ íŒŒì¼ (Apps Script ìš”êµ¬ì‚¬í•­ ì¶©ì¡±)
  - âš ï¸ **ì œì•½**: src/handlogger/code.gs ë‹¨ë… ì‹¤í–‰ ë¶ˆê°€ (ë¹Œë“œ í•„ìˆ˜)
  - ðŸ“ **ì´ìœ **: Google Apps ScriptëŠ” import/require ë¯¸ì§€ì›
- **ì²´í¬ë¦¬ìŠ¤íŠ¸**:
  - [x] **Step 1**: src/common/common.gs ìƒì„± (ë¹ˆ íŒŒì¼)
  - [x] **Step 2**: handlogger_sub/handlogger_code.gs â†’ src/common/common.gsë¡œ ê³µí†µ í•¨ìˆ˜ **12ê°œ** ë³µì‚¬
  - [x] **Step 3**: src/handlogger/code.gs **ìˆ˜ì •** (ê³µí†µ í•¨ìˆ˜ 12ê°œ ì œê±°)
  - [x] **Step 4**: src/tracker/tracker.gs **ìˆ˜ì •** (ì¤‘ë³µ í•¨ìˆ˜ ì œê±°)
  - [x] **Step 5**: src/softsender/softsender_code.gs **ê²€ì¦** (ê³µí†µ í•¨ìˆ˜ ë¯¸ì‚¬ìš© í™•ì¸)
- **ì™„ë£Œì¼**: 2025-10-06
- **ê²°ê³¼**: src/common/common.gs (118 lines, 12 functions)

### 2.2 ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ ìˆ˜ì • âœ… ì™„ë£Œ
- **ê·¼ê±°**: LLDì˜ "ë¹Œë“œ ì‹œ ì²˜ë¦¬ ë°©ì‹"
- **ì„±ê³µ**: ê³µí†µ í•¨ìˆ˜ 1íšŒë§Œ ì¡´ìž¬, ë¹Œë“œ í¬ê¸° 8% ê°ì†Œ
- **í˜„ìž¬ build.js ë¬¸ì œ**:
  - âŒ HandLoggerê°€ ê³µí†µ í•¨ìˆ˜ ì œê³µìžë¡œ ê°€ì • (line 32-47)
  - âŒ Trackerê°€ "HandLoggerì—ì„œ ê³µìœ " ì£¼ì„ (ìž˜ëª»ëœ ì˜ì¡´ì„±)
  - âœ… ìˆ˜ì • í•„ìš”: src/common/ì„ ê³µí†µ í•¨ìˆ˜ ì œê³µìžë¡œ ë³€ê²½
- **ì˜ì¡´ì„± ë³´ìž¥**: ë³‘í•© ìˆœì„œ ì—„ìˆ˜
  ```javascript
  // ìˆ˜ì • ì „ (í˜„ìž¬ - ìž˜ëª»ë¨)
  const handloggerCode = ...  // ê³µí†µ í•¨ìˆ˜ í¬í•¨
  const trackerCleaned = trackerCode.replace(...)  // "HandLoggerì—ì„œ ê³µìœ "

  // ìˆ˜ì • í›„ (ì˜¬ë°”ë¦„)
  const commonCode = fs.readFileSync('src/common/common.gs', 'utf8');
  const handloggerCode = ...  // ê³µí†µ í•¨ìˆ˜ ì œê±°ë¨
  const trackerCleaned = trackerCode.replace(...)  // "commonì—ì„œ ê³µìœ "

  const merged = [
    commonCode,        // 1ï¸âƒ£ ê³µí†µ í•¨ìˆ˜ ì •ì˜
    handloggerCode,    // 2ï¸âƒ£ HandLogger (í˜¸ì¶œë§Œ)
    prefixedTracker,   // 3ï¸âƒ£ Tracker (í˜¸ì¶œë§Œ)
    prefixedSoft       // 4ï¸âƒ£ SoftSender (í˜¸ì¶œë§Œ)
  ].join('\n\n');
  ```
- **ì²´í¬ë¦¬ìŠ¤íŠ¸**:
  - [x] **Step 1**: build.js ìƒë‹¨ì— `const versionCode`, `const commonCode` ì¶”ê°€
  - [x] **Step 2**: trackerCleaned ì£¼ì„ ìˆ˜ì • ("commonì—ì„œ ê³µìœ ")
  - [x] **Step 3**: ë³‘í•© ìˆœì„œ ìˆ˜ì • (version â†’ common â†’ handlogger â†’ tracker â†’ soft)
  - [x] **Step 4**: npm run build í…ŒìŠ¤íŠ¸ ì„±ê³µ
- **ì™„ë£Œì¼**: 2025-10-06
- **ê²°ê³¼**: build.js v2.7.0 (ë³‘í•© ìˆœì„œ ìˆ˜ì •)

### 2.3 ê²€ì¦ ë° ë°°í¬ âœ… ì™„ë£Œ
- **ê·¼ê±°**: PLANì˜ "ë°°í¬ ì—ëŸ¬ìœ¨ â‰¤ 1%"
- **ì„±ê³µ**: ëª¨ë“  íƒ­ ì •ìƒ ë™ìž‘, í•¨ìˆ˜ í˜¸ì¶œ ì—ëŸ¬ 0ê±´
- **ìžë™ ê²€ì¦ ìŠ¤í¬ë¦½íŠ¸ êµ¬í˜„**: verify-build.js
  ```javascript
  // verify-build.js
  const fs = require('fs');
  const dist = fs.readFileSync('./dist/code.gs', 'utf8').split('\n');

  const commonFunctions = [
    'withScriptLock_', 'appSS_', 'getOrCreateSheet_',
    'setHeaderIfEmpty_', 'readAll_', 'findColIndex_',
    'toInt_', 'numComma_', 'nowKST_', 'todayStartKST_',
    'readRoster_', 'extractTimeHHMM_'  // â­ 12ê°œë¡œ ìˆ˜ì •
  ];

  // 1. ì •ì˜ ìœ„ì¹˜ ì°¾ê¸°
  const defLines = {};
  commonFunctions.forEach(fn => {
    const idx = dist.findIndex(l => l.match(new RegExp(`^function ${fn}\\(`)));
    if (idx === -1) {
      console.error(`âŒ ${fn} ì •ì˜ ì—†ìŒ!`);
      process.exit(1);
    }
    defLines[fn] = idx + 1;
  });

  // 2. ì¤‘ë³µ í™•ì¸
  commonFunctions.forEach(fn => {
    const count = dist.filter(l => l.match(new RegExp(`^function ${fn}\\(`))).length;
    if (count > 1) {
      console.error(`âŒ ${fn} ì¤‘ë³µ (${count}íšŒ)!`);
      process.exit(1);
    }
  });

  // 3. ì •ì˜ ì´ì „ í˜¸ì¶œ í™•ì¸
  commonFunctions.forEach(fn => {
    for (let i = 0; i < defLines[fn] - 1; i++) {
      if (dist[i].match(new RegExp(`${fn}\\(`)) && !dist[i].match(/^function/)) {
        console.error(`âŒ ${fn} ì •ì˜(${defLines[fn]}ì¤„) ì´ì „ í˜¸ì¶œ(${i+1}ì¤„)!`);
        process.exit(1);
      }
    }
  });

  console.log('âœ… ëª¨ë“  ê²€ì¦ í†µê³¼!');
  ```
- **ì²´í¬ë¦¬ìŠ¤íŠ¸**:
  - [x] **Step 1**: verify-build.js ìƒì„±
  - [x] **Step 2**: package.json ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€
  - [x] **Step 3**: npm run verify í…ŒìŠ¤íŠ¸ ì„±ê³µ (12ê°œ í•¨ìˆ˜ ëª¨ë‘ í†µê³¼)
  - [x] **Step 4**: npm run push â†’ ìžë™ ë¹Œë“œ + ê²€ì¦ + ë°°í¬ ì„±ê³µ
  - [ ] **Step 5**: ì›¹ì•± 5ê°œ íƒ­ ë™ìž‘ í…ŒìŠ¤íŠ¸ (ë‹¤ìŒ ë‹¨ê³„)
- **ì™„ë£Œì¼**: 2025-10-06
- **ê²°ê³¼**: verify-build.js ìƒì„±, ìžë™ ë°°í¬ íŒŒì´í”„ë¼ì¸ êµ¬ì¶•

---

## Phase 3: ë°°í¬ ê²€ì¦ (í˜„ìž¬ ì§„í–‰ ì¤‘)

### 3.1 ë²„ì „ 8 ì›¹ì•± í…ŒìŠ¤íŠ¸ ðŸŸ¡ Medium
- **ê·¼ê±°**: PLANì˜ ì‹œë‚˜ë¦¬ì˜¤ 1 (ì²« í†µí•© ë°°í¬ ê²€ì¦)
- **ì„±ê³µ**: 5ê°œ íƒ­ ëª¨ë‘ ì •ìƒ ë™ìž‘ í™•ì¸
- **ì²´í¬ë¦¬ìŠ¤íŠ¸**:
  - [ ] Record íƒ­: í•¸ë“œ ìž…ë ¥ â†’ HANDS ì‹œíŠ¸ ì €ìž¥ í™•ì¸
  - [ ] Review íƒ­: í•¸ë“œ ì¡°íšŒ â†’ VIRTUAL ì „ì†¡ í™•ì¸
  - [ ] Tracker íƒ­: í‚¤ í”Œë ˆì´ì–´ ê´€ë¦¬ â†’ TYPE ì‹œíŠ¸ ì—…ë°ì´íŠ¸ í™•ì¸
  - [ ] SoftSender íƒ­: VIRTUAL ì»¨í…ì¸  ì „ì†¡ í™•ì¸
  - [ ] Settings íƒ­: Sheet ID ì„¤ì • â†’ localStorage ì €ìž¥ í™•ì¸
- **ì˜ˆìƒ**: 30ë¶„
- **ì˜ì¡´ì„±**: ë²„ì „ 8 ë°°í¬ ì™„ë£Œ

---

## Phase 4: ê°œì„  ìž‘ì—… (v2.8~)

### 4.1 BB ìž…ë ¥ ë””ë°”ìš´ì‹± ðŸŸ¢ Low
- **ê·¼ê±°**: STATUSì˜ "ë‹¤ìŒ ìš°ì„ ìˆœìœ„ Phase 2.1"
- **ì„±ê³µ**: BB ìž…ë ¥ ì‹œ 500ms ì§€ì—° í›„ ìžë™ ê³„ì‚°
- **ì²´í¬ë¦¬ìŠ¤íŠ¸**:
  - [ ] debounce() í•¨ìˆ˜ êµ¬í˜„
  - [ ] BB ìž…ë ¥ í•„ë“œì— ì ìš©
  - [ ] í…ŒìŠ¤íŠ¸: ë¹ ë¥¸ ìž…ë ¥ ì‹œ 1íšŒë§Œ ê³„ì‚° í™•ì¸
- **ì˜ˆìƒ**: 1ì‹œê°„
- **ì˜ì¡´ì„±**: ì—†ìŒ

### 4.2 Commit ë²„íŠ¼ ì¤‘ë³µ í´ë¦­ ë°©ì§€ ðŸŸ¢ Low
- **ê·¼ê±°**: STATUSì˜ "ë‹¤ìŒ ìš°ì„ ìˆœìœ„ Phase 2.2"
- **ì„±ê³µ**: Commit ì‹¤í–‰ ì¤‘ ë²„íŠ¼ ë¹„í™œì„±í™”
- **ì²´í¬ë¦¬ìŠ¤íŠ¸**:
  - [ ] commitHand() í˜¸ì¶œ ì‹œ ë²„íŠ¼ disabled
  - [ ] ì„±ê³µ/ì‹¤íŒ¨ í›„ ë²„íŠ¼ í™œì„±í™”
  - [ ] í…ŒìŠ¤íŠ¸: ì—°ì† í´ë¦­ ì‹œ 1íšŒë§Œ ì €ìž¥ í™•ì¸
- **ì˜ˆìƒ**: 30ë¶„
- **ì˜ì¡´ì„±**: ì—†ìŒ

### 4.3 ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ í•´ê²° ðŸŸ¢ Low
- **ê·¼ê±°**: STATUSì˜ "ë‹¤ìŒ ìš°ì„ ìˆœìœ„ Phase 2.3"
- **ì„±ê³µ**: ëª¨ë“œ ì „í™˜ ì‹œ ì´ì „ ë¦¬ìŠ¤ë„ˆ ì œê±°
- **ì²´í¬ë¦¬ìŠ¤íŠ¸**:
  - [ ] removeEventListener() í˜¸ì¶œ êµ¬ì¡° ì„¤ê³„
  - [ ] setMode() í•¨ìˆ˜ ë¦¬íŒ©í† ë§
  - [ ] í…ŒìŠ¤íŠ¸: ëª¨ë“œ 100íšŒ ì „í™˜ í›„ ë©”ëª¨ë¦¬ í™•ì¸
- **ì˜ˆìƒ**: 2ì‹œê°„
- **ì˜ì¡´ì„±**: ì—†ìŒ

---

## Phase 5: í–¥í›„ ë¹„ì „ (v3.0~)

### 5.1 Hot Reload ðŸŸ¡ Medium
- **ê·¼ê±°**: PLANì˜ "Phase 2 í–¥í›„ ë¹„ì „"
- **ì„±ê³µ**: src/ íŒŒì¼ ë³€ê²½ ì‹œ ìžë™ ë¹Œë“œ + ìžë™ ë°°í¬
- **ì²´í¬ë¦¬ìŠ¤íŠ¸**:
  - [ ] chokidarë¡œ íŒŒì¼ ê°ì‹œ
  - [ ] ë³€ê²½ ì‹œ ìžë™ build + push
  - [ ] ë°°í¬ ì™„ë£Œ ì•Œë¦¼
- **ì˜ˆìƒ**: 4ì‹œê°„
- **ì˜ì¡´ì„±**: ì—†ìŒ

### 5.2 TypeScript ì „í™˜ ðŸŸ¡ Medium
- **ê·¼ê±°**: PLANì˜ "Phase 2 í–¥í›„ ë¹„ì „"
- **ì„±ê³µ**: íƒ€ìž… ì•ˆì •ì„± í™•ë³´, IDE ìžë™ì™„ì„±
- **ì²´í¬ë¦¬ìŠ¤íŠ¸**:
  - [ ] @types/google-apps-script ì„¤ì¹˜
  - [ ] code.gs â†’ code.ts ë³€í™˜
  - [ ] tsconfig.json ì„¤ì •
  - [ ] ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ TypeScript ì§€ì›
- **ì˜ˆìƒ**: 8ì‹œê°„
- **ì˜ì¡´ì„±**: ì—†ìŒ

### 5.3 í…ŒìŠ¤íŠ¸ ìžë™í™” ðŸŸ¢ Low
- **ê·¼ê±°**: PLANì˜ "Phase 2 í–¥í›„ ë¹„ì „"
- **ì„±ê³µ**: ë¹Œë“œ ì „ í•¨ìˆ˜ í˜¸ì¶œ ê²€ì¦
- **ì²´í¬ë¦¬ìŠ¤íŠ¸**:
  - [ ] Jest ì„¤ì¹˜
  - [ ] í•µì‹¬ í•¨ìˆ˜ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ìž‘ì„±
  - [ ] CI/CD íŒŒì´í”„ë¼ì¸ í†µí•©
- **ì˜ˆìƒ**: 12ì‹œê°„
- **ì˜ì¡´ì„±**: 5.2 ì™„ë£Œ ê¶Œìž¥

---

## ìš°ì„ ìˆœìœ„ ìš”ì•½

| Phase | ìž‘ì—… | ìš°ì„ ìˆœìœ„ | ì˜ˆìƒ ì‹œê°„ | ì˜ì¡´ì„± |
|-------|------|----------|-----------|--------|
| **2.1** | ê³µí†µ ëª¨ë“ˆ ì¶”ì¶œ | ðŸ”´ High | 3h | ì—†ìŒ |
| **2.2** | ë¹Œë“œ ìŠ¤í¬ë¦½íŠ¸ ìˆ˜ì • | ðŸ”´ High | 2h | 2.1 |
| **2.3** | ê²€ì¦ ë° ë°°í¬ | ðŸ”´ High | 2h | 2.2 |
| **3.1** | ë²„ì „ 8 í…ŒìŠ¤íŠ¸ | ðŸŸ¡ Medium | 30m | ë°°í¬ ì™„ë£Œ |
| **4.1** | BB ë””ë°”ìš´ì‹± | ðŸŸ¢ Low | 1h | ì—†ìŒ |
| **4.2** | Commit ì¤‘ë³µ ë°©ì§€ | ðŸŸ¢ Low | 30m | ì—†ìŒ |
| **4.3** | ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ í•´ê²° | ðŸŸ¢ Low | 2h | ì—†ìŒ |
| **5.1** | Hot Reload | ðŸŸ¡ Medium | 4h | ì—†ìŒ |
| **5.2** | TypeScript ì „í™˜ | ðŸŸ¡ Medium | 8h | ì—†ìŒ |
| **5.3** | í…ŒìŠ¤íŠ¸ ìžë™í™” | ðŸŸ¢ Low | 12h | 5.2 ê¶Œìž¥ |

---

## ðŸ”— ê´€ë ¨ ë¬¸ì„œ

- [PLAN.md](PLAN.md) - í”„ë¡œì íŠ¸ ë¹„ì „
- [LLD.md](LLD.md) - ê¸°ìˆ  ì„¤ê³„
- [STATUS.md](STATUS.md) - í˜„ìž¬ ìƒíƒœ
- [CHANGELOG.md](CHANGELOG.md) - ì™„ë£Œ ì´ë ¥
