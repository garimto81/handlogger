<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>HandLogger í´ë¼ì´ì–¸íŠ¸ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸</title>
  <style>
    body {
      font-family: 'Courier New', monospace;
      background: #0b0d12;
      color: #e7eaf0;
      padding: 20px;
      line-height: 1.6;
    }
    h1 { color: #2a6fff; }
    h2 { color: #a9b8ff; margin-top: 30px; }
    .result {
      background: #101522;
      border: 1px solid #2a3249;
      border-radius: 8px;
      padding: 12px;
      margin: 10px 0;
      font-size: 14px;
    }
    .fast { color: #22c55e; }
    .medium { color: #f59e0b; }
    .slow { color: #ef4444; }
    button {
      background: #2a6fff;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 24px;
      font-size: 16px;
      cursor: pointer;
      margin: 5px;
    }
    button:hover { background: #1e5bdd; }
    .status { margin: 20px 0; font-size: 18px; }
    pre {
      background: #0f1320;
      border: 1px solid #2a3249;
      border-radius: 8px;
      padding: 12px;
      overflow-x: auto;
      font-size: 12px;
    }
  </style>
</head>
<body>
  <h1>âš¡ HandLogger í´ë¼ì´ì–¸íŠ¸ ì„±ëŠ¥ í…ŒìŠ¤íŠ¸</h1>

  <div class="status" id="status">ì¤€ë¹„ë¨</div>

  <button onclick="runAllTests()">ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
  <button onclick="testDOMOperations()">DOM ì—°ì‚° í…ŒìŠ¤íŠ¸</button>
  <button onclick="testDataProcessing()">ë°ì´í„° ì²˜ë¦¬ í…ŒìŠ¤íŠ¸</button>
  <button onclick="testRenderPerformance()">ë Œë”ë§ í…ŒìŠ¤íŠ¸</button>
  <button onclick="clearResults()">ê²°ê³¼ ì§€ìš°ê¸°</button>

  <h2>ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼</h2>
  <div id="results"></div>

  <script>
    const results = [];

    function log(message, type = 'info') {
      const div = document.createElement('div');
      div.className = 'result';
      div.innerHTML = message;
      document.getElementById('results').appendChild(div);
      console.log(message.replace(/<[^>]*>/g, ''));
    }

    function clearResults() {
      document.getElementById('results').innerHTML = '';
      results.length = 0;
    }

    function updateStatus(msg) {
      document.getElementById('status').textContent = msg;
    }

    function measureTime(name, fn) {
      const start = performance.now();
      try {
        const result = fn();
        const time = performance.now() - start;

        const timeStr = time < 1 ? `${time.toFixed(2)}ms` : `${time.toFixed(0)}ms`;
        const className = time < 10 ? 'fast' : time < 50 ? 'medium' : 'slow';
        const icon = time < 10 ? 'ğŸŸ¢' : time < 50 ? 'ğŸŸ¡' : 'ğŸ”´';

        results.push({ name, time, success: true });
        log(`${icon} <span class="${className}">${name}: ${timeStr}</span>`);
        return result;
      } catch(e) {
        results.push({ name, time: 0, success: false, error: e.message });
        log(`âŒ ${name}: ì˜¤ë¥˜ - ${e.message}`);
        return null;
      }
    }

    // ===== ì „ì²´ í…ŒìŠ¤íŠ¸ =====
    function runAllTests() {
      clearResults();
      updateStatus('í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘...');

      log('<h3>ğŸ” DOM ì—°ì‚° í…ŒìŠ¤íŠ¸</h3>');
      testDOMOperations();

      log('<h3>âš™ï¸ ë°ì´í„° ì²˜ë¦¬ í…ŒìŠ¤íŠ¸</h3>');
      testDataProcessing();

      log('<h3>ğŸ¨ ë Œë”ë§ í…ŒìŠ¤íŠ¸</h3>');
      testRenderPerformance();

      // ê²°ê³¼ ìš”ì•½
      setTimeout(() => {
        showSummary();
        updateStatus('í…ŒìŠ¤íŠ¸ ì™„ë£Œ');
      }, 100);
    }

    // ===== DOM ì—°ì‚° í…ŒìŠ¤íŠ¸ =====
    function testDOMOperations() {
      // 1. getElementById ì„±ëŠ¥
      measureTime('getElementById (100íšŒ)', () => {
        for(let i = 0; i < 100; i++) {
          document.getElementById('results');
        }
      });

      // 2. querySelector ì„±ëŠ¥
      measureTime('querySelector (100íšŒ)', () => {
        for(let i = 0; i < 100; i++) {
          document.querySelector('#results');
        }
      });

      // 3. createElement + appendChild
      measureTime('createElement + appendChild (100ê°œ)', () => {
        const container = document.createElement('div');
        for(let i = 0; i < 100; i++) {
          const div = document.createElement('div');
          div.textContent = `Item ${i}`;
          container.appendChild(div);
        }
      });

      // 4. innerHTML (ë‹¨ì¼ í• ë‹¹)
      measureTime('innerHTML (100ê°œ ìš”ì†Œ)', () => {
        const container = document.createElement('div');
        let html = '';
        for(let i = 0; i < 100; i++) {
          html += `<div>Item ${i}</div>`;
        }
        container.innerHTML = html;
      });

      // 5. classList ì¡°ì‘
      measureTime('classList.add/remove (1000íšŒ)', () => {
        const div = document.createElement('div');
        for(let i = 0; i < 1000; i++) {
          div.classList.add('test');
          div.classList.remove('test');
        }
      });
    }

    // ===== ë°ì´í„° ì²˜ë¦¬ í…ŒìŠ¤íŠ¸ =====
    function testDataProcessing() {
      // 1. JSON.parse (ì‘ì€ ê°ì²´)
      const smallJson = JSON.stringify({ seat: 1, player: 'Test', chips: 10000 });
      measureTime('JSON.parse (ì‘ì€ ê°ì²´)', () => {
        for(let i = 0; i < 1000; i++) {
          JSON.parse(smallJson);
        }
      });

      // 2. JSON.parse (í° ê°ì²´ - í•¸ë“œ ë°ì´í„°)
      const largeJson = JSON.stringify({
        hand_id: '20250116_123456',
        table_id: '1',
        actions: Array(50).fill({ seq: 1, street: 'preflop', seat: '1', action: 'call' })
      });
      measureTime('JSON.parse (í° ê°ì²´)', () => {
        for(let i = 0; i < 100; i++) {
          JSON.parse(largeJson);
        }
      });

      // 3. Array.map (1000ê°œ)
      const arr = Array(1000).fill(0).map((_, i) => i);
      measureTime('Array.map (1000ê°œ)', () => {
        arr.map(x => x * 2);
      });

      // 4. Array.filter (1000ê°œ)
      measureTime('Array.filter (1000ê°œ)', () => {
        arr.filter(x => x % 2 === 0);
      });

      // 5. Array.sort (1000ê°œ)
      const unsorted = [...arr].reverse();
      measureTime('Array.sort (1000ê°œ)', () => {
        [...unsorted].sort((a, b) => a - b);
      });

      // 6. String.replace (ì •ê·œì‹)
      const str = '1234567890'.repeat(100);
      measureTime('String.replace (ì •ê·œì‹, 1000ì)', () => {
        str.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
      });

      // 7. Object ë³µì‚¬ (spread)
      const obj = { a: 1, b: 2, c: 3, d: 4, e: 5 };
      measureTime('Object spread (1000íšŒ)', () => {
        for(let i = 0; i < 1000; i++) {
          const copy = { ...obj };
        }
      });

      // 8. Object ë³µì‚¬ (Object.assign)
      measureTime('Object.assign (1000íšŒ)', () => {
        for(let i = 0; i < 1000; i++) {
          const copy = Object.assign({}, obj);
        }
      });
    }

    // ===== ë Œë”ë§ í…ŒìŠ¤íŠ¸ =====
    function testRenderPerformance() {
      // 1. ì¹´ë“œ ë°°ì§€ ë Œë”ë§ (52ê°œ)
      measureTime('ì¹´ë“œ ë°°ì§€ ë Œë”ë§ (52ê°œ)', () => {
        const suits = ['s', 'h', 'd', 'c'];
        const ranks = ['A', 'K', 'Q', 'J', 'T', '9', '8', '7', '6', '5', '4', '3', '2'];
        let html = '';
        suits.forEach(suit => {
          ranks.forEach(rank => {
            html += `<span class="cardBadge cb-${suit}">${rank}</span>`;
          });
        });
        const div = document.createElement('div');
        div.innerHTML = html;
      });

      // 2. í•¸ë“œ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ (50ê°œ)
      measureTime('í•¸ë“œ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ (50ê°œ)', () => {
        let html = '';
        for(let i = 0; i < 50; i++) {
          html += `
            <div class="seatCard">
              <div><b>#${i}</b> Â· Table 1 Â· BTN 5</div>
              <div class="small">2025-01-16 12:00:00</div>
            </div>
          `;
        }
        const div = document.createElement('div');
        div.innerHTML = html;
      });

      // 3. ì¢Œì„ Pills ë Œë”ë§ (9ê°œ)
      measureTime('ì¢Œì„ Pills ë Œë”ë§ (9ê°œ)', () => {
        let html = '';
        for(let i = 1; i <= 9; i++) {
          html += `
            <div class="seatPill">
              <div>${i}</div>
              <div class="small">Player ${i}</div>
            </div>
          `;
        }
        const div = document.createElement('div');
        div.innerHTML = html;
      });

      // 4. ì•¡ì…˜ ë¡œê·¸ ë Œë”ë§ (20ê°œ)
      measureTime('ì•¡ì…˜ ë¡œê·¸ ë Œë”ë§ (20ê°œ)', () => {
        let html = '';
        const actions = ['fold', 'call', 'raise', 'bet', 'check'];
        for(let i = 0; i < 20; i++) {
          const action = actions[i % actions.length];
          html += `<span class="actBadge act-${action}">${action.toUpperCase()}</span>`;
        }
        const div = document.createElement('div');
        div.innerHTML = html;
      });

      // 5. ë³´ë“œ ì¹´ë“œ ë Œë”ë§ (5ì¥)
      measureTime('ë³´ë“œ ì¹´ë“œ ë Œë”ë§ (5ì¥)', () => {
        const cards = ['As', 'Kh', 'Qd', 'Jc', 'Ts'];
        let html = '';
        cards.forEach(card => {
          const rank = card[0];
          const suit = card[1];
          const symbol = suit === 's' ? 'â™ ' : suit === 'h' ? 'â™¥' : suit === 'd' ? 'â™¦' : 'â™£';
          html += `<span class="cardBadge cb-${suit}">${rank}${symbol}</span>`;
        });
        const div = document.createElement('div');
        div.innerHTML = html;
      });
    }

    // ===== ê²°ê³¼ ìš”ì•½ =====
    function showSummary() {
      log('<h3>ğŸ“ˆ ìš”ì•½</h3>');

      const successful = results.filter(r => r.success);
      const failed = results.filter(r => !r.success);

      log(`ì´ ${results.length}ê°œ í…ŒìŠ¤íŠ¸ (ì„±ê³µ: ${successful.length}, ì‹¤íŒ¨: ${failed.length})`);

      if(successful.length > 0) {
        // ê°€ì¥ ëŠë¦° 5ê°œ
        const slowest = [...successful].sort((a, b) => b.time - a.time).slice(0, 5);
        log('<h4>ğŸŒ ê°€ì¥ ëŠë¦° 5ê°œ:</h4>');
        slowest.forEach((r, i) => {
          log(`${i+1}. ${r.name}: ${r.time.toFixed(2)}ms`);
        });

        // ê°€ì¥ ë¹ ë¥¸ 5ê°œ
        const fastest = [...successful].sort((a, b) => a.time - b.time).slice(0, 5);
        log('<h4>âš¡ ê°€ì¥ ë¹ ë¥¸ 5ê°œ:</h4>');
        fastest.forEach((r, i) => {
          log(`${i+1}. ${r.name}: ${r.time.toFixed(2)}ms`);
        });

        // í‰ê·  ì‹œê°„
        const avgTime = successful.reduce((sum, r) => sum + r.time, 0) / successful.length;
        log(`<h4>ğŸ“Š í‰ê·  ì‹œê°„: ${avgTime.toFixed(2)}ms</h4>`);
      }

      if(failed.length > 0) {
        log('<h4>âŒ ì‹¤íŒ¨í•œ í…ŒìŠ¤íŠ¸:</h4>');
        failed.forEach(r => {
          log(`- ${r.name}: ${r.error}`);
        });
      }
    }

    // ìë™ ì‹¤í–‰ (í˜ì´ì§€ ë¡œë“œ ì‹œ)
    window.addEventListener('load', () => {
      log('ì¤€ë¹„ ì™„ë£Œ. ë²„íŠ¼ì„ í´ë¦­í•˜ì—¬ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•˜ì„¸ìš”.');
    });
  </script>
</body>
</html>
